# Установка кодировки
AddDefaultCharset utf-8

# Запрет листинга директории
Options -Indexes

# Заголовки для изображений
<FilesMatch "\.(jpg|jpeg|png|gif|webp|bmp)$">
    Header set Cache-Control "public, max-age=31536000"
    Header set Access-Control-Allow-Origin "*"
</FilesMatch>

# Заголовки для CSS и JS файлов
<FilesMatch "\.(css|js)$">
    Header set Cache-Control "public, max-age=86400"
    Header set Access-Control-Allow-Origin "*"
</FilesMatch>

RewriteEngine on 
RewriteBase /

# Разрешаем прямой доступ к статическим файлам
RewriteCond %{REQUEST_FILENAME} -f
RewriteCond %{REQUEST_URI} \.(css|js|png|jpg|jpeg|gif|webp|bmp|ico|pdf|doc|docx|xls|xlsx|zip|rar|ttf|woff|woff2|eot)$ [NC]
RewriteRule ^(.*)$ - [L]

# Разрешаем доступ к папке assets
RewriteCond %{REQUEST_URI} ^/assets/
RewriteRule ^(.*)$ - [L]

# Настройки ЧПУ для остальных запросов
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !\.(css|js|png|jpg|jpeg|gif|webp|bmp|ico|pdf|doc|docx|xls|xlsx|zip|rar|ttf|woff|woff2|eot)$ [NC]

ErrorDocument 404 /error
ErrorDocument 403 /error

RewriteRule ^(.*)$ index.php?action=$1 [L,QSA]

# Защита от хотлинкинга изображений (только для внешних доменов)
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http://(www\.)?gtec-bks\.by/.*$ [NC]
RewriteCond %{HTTP_REFERER} !^http://(www\.)?localhost/.*$ [NC]
RewriteCond %{HTTP_REFERER} !^http://(www\.)?127\.0\.0\.1/.*$ [NC]
RewriteCond %{HTTP_REFERER} !^http://(www\.)?nocontrgtec/.*$ [NC]
RewriteCond %{HTTP_REFERER} !^https://(www\.)?gtec-bks\.by/.*$ [NC]
RewriteCond %{HTTP_REFERER} !^https://(www\.)?localhost/.*$ [NC]
RewriteCond %{HTTP_REFERER} !^https://(www\.)?127\.0\.0\.1/.*$ [NC]
RewriteCond %{HTTP_REFERER} !^https://(www\.)?nocontrgtec/.*$ [NC]
RewriteRule \.(jpg|jpeg|gif|png|bmp|webp)$ - [F,NC]

